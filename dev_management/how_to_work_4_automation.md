---
marp: true
paginate: true
---

# 程序员工作法-自动化

**基于《10x程序员工作法》的笔记**

---

- [程序员工作法-自动化](#程序员工作法-自动化)
    - [“懒惰”应该是所有程序员的骄傲](#懒惰应该是所有程序员的骄傲)
        - [能不做的事情就不做](#能不做的事情就不做)
        - [通过软件设计来打造自动化工具](#通过软件设计来打造自动化工具)
    - [开发过程的自动化](#开发过程的自动化)
    - [开发的产物部署起来](#开发的产物部署起来)
    - [持续交付](#持续交付)
        - [DevOps](#devops)
    - [如何做验收测试](#如何做验收测试)

---

## “懒惰”应该是所有程序员的骄傲

**请谨慎地将工作自动化。**

> 优秀程序员应该有三大美德：懒惰、急躁和傲慢（Laziness, Impatience and hubris）。
> 
> -- Perl 语言的发明人 Larry Wall 

- 懒惰，是一种品质，它会使你花很大力气去规避过度的精力消耗，敦促你写出节省体力的程序，别人也能很好地利用，你还会为此写出完善的文档，以免别人来问问题。
- 急躁，是计算机偷懒时，你会感到的一种愤怒。它会促使你写出超越预期的程序，而不只是响应需求。
- 傲慢，极度自信，写出（或维护）别人挑不出毛病的程序。

---

### 能不做的事情就不做

- 不要自动化
    - 注定会失败的项目，不去做才是项目的成功。
    - 做有价值的事是重要的，这里面的有价值，不仅仅是“做”了什么，通过“不做”节省时间和成本也是有价值的。
- 小心 NIH 综合症
    - NIH 是什么意思？就是有人特别看不上别人做的东西，非要自己做出一套来，原因只是因为那个东西不是我做的，可能存在各种问题。
    - 因为水平限制，自己做的东西一般都不好用
- 做好自动化
    - 你的日常工作是给别人打造自动化，但你自己的工作够自动化吗？

---

### 通过软件设计来打造自动化工具

我们打造自动化工具所需要的能力：软件设计

- 设计和实现是两回事
- 设计应该脱离技术实现，做到技术不断变化也能保证程序能够快速适应。

---

## 开发过程的自动化

**将你的工作过程自动化。**

- 编译；
- 打包；
- 运行测试；
- 代码风格检查；
- 测试覆盖率；
- 数据库迁移；
- 运行应用。

---

<style scoped>
section {
    font-size: 22px;
}
</style>

## 开发的产物部署起来

**有体系地学习运维知识。**

[DevOps 技术栈](https://chaifeng.com/devops-tech-stack/)

| 类别         | 内容                                                                       |
| ------------ | -------------------------------------------------------------------------- |
| 语言         | Shell                                                                      |
| 核心命令     | Linux 核心命令                                                             |
| 第三方命令   | rsync、curl等                                                              |
| 配置管理工具 | Chef、Puppet、Ansible等                                                    |
| 部署环境     | 虚拟机、Docker等                                                           |
| 集群部署     | 云服务：Amazon AWS、阿里云等；<br>Docker集群：Kubernetes、Docker Swarm等； |

---

<style scoped>
section {
    font-size: 22px;
}
</style>

## 持续交付

**将部署纳入开发的考量。**

持续交付：它就是一种让软件随时处于可以部署到生产环境的能力。

从打好的包到部署到生产环境中间还差什么

- 验证发布包：持续集成的环境往往是单机的，主要强调功能验证，而一些与生产环境相关的测试往往是欠缺的；
- 部署到生产环境。

一般持续交付的基础设施：

- 测试环境：一般是单机的，主要负责功能验证。
- 预生产环境：一般与生产环境配置相同。负载均衡和集群之类的都有，但机器数量少一些。负责验证部署环境，例如多机并发的问题。
- 生产环境：真是的线上环境。

在持续集成后，按照顺序部署到以上环境并验证的过程，称之为构建流水线（Build Pipeline）。

一旦通过了各种验证，就会到构建流水线的最后一个阶段，生产发布。这个部分可以手动也可以自动化。

---

### DevOps

- 早期的部署都是通过自己编写 Shell 脚本来完成的。
- 目前有各种各样的工具，大幅度地简化了部署脚本的编写。
- 基础设施即代码（Infrastructure as code）。例如：Docker

---

## 如何做验收测试

**将验收测试自动化。**

- 验收测试
    - 确认应用是否满足设计规范的测试。这种测试往往是站在用户的角度，看整个应用能否满足业务需求。
- BDD
    - 如果你想做 BDD，就应该用业务语言进行描述。
    - Cucumber
- 写好眼熟测试用例
    - 想写好 BDD 的测试用例，关键点在用业务视角描述，而不是实现的角度进行描述。
